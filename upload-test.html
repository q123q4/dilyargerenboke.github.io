<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>图片上传测试</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .upload-area {
            border: 2px dashed #ccc;
            border-radius: 8px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: border-color 0.3s;
        }
        .upload-area:hover {
            border-color: #667eea;
        }
        .preview {
            margin-top: 20px;
            display: none;
        }
        .preview img {
            max-width: 100%;
            border-radius: 8px;
        }
        button {
            margin-top: 10px;
            padding: 8px 16px;
            background-color: #667eea;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>图片上传测试</h1>
    
    <h2>编辑博客模态框图片上传测试</h2>
    <div class="upload-area" id="editImageUploadArea">
        <input type="file" id="editBlogImage" class="hidden" accept="image/*">
        <i class="fa fa-upload" style="font-size: 48px; color: #ccc;"></i>
        <p>点击上传新的封面图片</p>
    </div>
    <div class="preview" id="editImagePreview">
        <img id="editCurrentImage" src="" alt="预览图">
    </div>
    
    <h2>新建博客图片上传测试</h2>
    <div class="upload-area" id="blogImageUploadArea">
        <input type="file" id="blogImage" class="hidden" accept="image/*">
        <i class="fa fa-upload" style="font-size: 48px; color: #ccc;"></i>
        <p>点击上传封面图片</p>
    </div>
    <div class="preview" id="blogImagePreview">
        <img id="blogCurrentImage" src="" alt="预览图">
    </div>
    
    <script>
        // 测试编辑模态框中的图片上传功能
        const editImageUploadArea = document.getElementById('editImageUploadArea');
        const editBlogImageInput = document.getElementById('editBlogImage');
        const editImagePreview = document.getElementById('editImagePreview');
        const editCurrentImage = document.getElementById('editCurrentImage');
        
        if (editImageUploadArea && editBlogImageInput) {
            editImageUploadArea.addEventListener('click', () => {
                console.log('编辑模态框上传区域被点击');
                editBlogImageInput.click();
            });
            
            editBlogImageInput.addEventListener('click', (e) => {
                e.stopPropagation();
                console.log('文件输入框被点击');
            });
            
            // 添加图片选择后的预览功能
            editBlogImageInput.addEventListener('change', function() {
                if (this.files && this.files[0]) {
                    console.log('选择了图片:', this.files[0].name);
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        console.log('图片读取完成，显示预览');
                        editCurrentImage.src = e.target.result;
                        editImagePreview.style.display = 'block';
                    }
                    
                    reader.readAsDataURL(this.files[0]);
                }
            });
        }
        
        // 测试新建博客中的图片上传功能
        const blogImageUploadArea = document.getElementById('blogImageUploadArea');
        const blogImageInput = document.getElementById('blogImage');
        const blogImagePreview = document.getElementById('blogImagePreview');
        const blogCurrentImage = document.getElementById('blogCurrentImage');
        
        if (blogImageUploadArea && blogImageInput) {
            blogImageUploadArea.addEventListener('click', () => {
                console.log('新建博客上传区域被点击');
                blogImageInput.click();
            });
            
            blogImageInput.addEventListener('click', (e) => {
                e.stopPropagation();
                console.log('文件输入框被点击');
            });
            
            // 添加图片选择后的预览功能
            blogImageInput.addEventListener('change', function() {
                if (this.files && this.files[0]) {
                    console.log('选择了图片:', this.files[0].name);
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        console.log('图片读取完成，显示预览');
                        blogCurrentImage.src = e.target.result;
                        blogImagePreview.style.display = 'block';
                    }
                    
                    reader.readAsDataURL(this.files[0]);
                }
            });
        }
        
        console.log('测试脚本加载完成');
    </script>
</body>
</html>